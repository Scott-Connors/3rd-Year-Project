---
title: "Global patterns in predatorâ€”prey size relationships, Analysis"
author: "Scott Connors"
date: "28/10/2020"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

First I need to load the correct packages and the data from the DAPSTOM database about haddock needs to be read into R.

```{r, message=FALSE}
library(tidyverse)
haddock_data <- read_csv("Haddock_Data.csv")
```

Visualising the data to check for errors.

```{r}
plot(haddock_data$`Mean length of predator`)
```

I want to create a tibble with the mean length of predator fish analysed per year.

```{r, message=FALSE}
annual_mean_length <- haddock_data %>% group_by(Year) %>% summarise(annual_predator_length = mean(`Mean length of predator`))
```

Next we plot the data as below, analysing mean lengths of predator fish per year.

```{r}
annual_mean_length %>% ggplot(aes(x=Year, y=annual_predator_length)) + geom_point() + geom_line() + ylab("Annual Mean Length [cm]")
```

For a new plot of prey types found in the different Sea's I first need to count the amount of each type of prey.

```{r}
prey_number <- haddock_data %>% group_by(`Prey common name`, Sea) %>% count()
```

Because there are a lot of prey types I'm going to remove Prey with less than 10 entries.

```{r}
prey_number <- prey_number %>% filter(n > 10)
```

Next need to remove the EPMTY values.

```{r}
prey_number <- prey_number[-c(4,5),]
```

Finally plot the prey types against amounts on separate plots for each sea using facet_wrap.

```{r, message=FALSE}
prey_number %>% ggplot(aes(x = n, y = `Prey common name`)) + geom_point() + geom_line() + facet_wrap(~Sea)
```